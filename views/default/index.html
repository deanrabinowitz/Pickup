{{extend 'layout.html'}} {{block head}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script src="{{=URL('static', 'js/jquery.timepicker.min.js')}}"></script>
<script src="{{=URL('static', 'js/lib/bootstrap-datepicker.js')}}"></script>
<script src="{{=URL('static', 'js/lib/site.js')}}"></script>
<script>
    var gamesURL = "{{=URL('api', 'get_games', hash_vars=False)}}";
    var addGameURL = "{{=URL('api', 'add_game', user_signature=True)}}";
    var getUserURL = "{{=URL('api', 'get_user')}}";
    var deleteGameURL = "{{=URL('api', 'delete_game', user_signature=True)}}";
    var joinGameURL = "{{=URL('api', 'join_game', user_signature=True)}}"
    var leaveGameURL = "{{=URL('api', 'leave_game', user_signature=True)}}"
</script> {{end}}

<div class="main_content">

    <div id="vue-div" class="display:none">

        <div class="center">
            <img src="{{=URL('static', 'images/pickup_icon.jpg')}}" height="70px" width="200px" class="padded" />
        </div>

        <div v-if="isAddingGame">
            <form action="#" v-on:submit.prevent class="form-horizontal" enctype="multipart/form-data" method="post">
                <div class="form-group">
                    <div>
                        <input class="form-control string" v-model="formTitle" placeholder="Title" type="text" />
                    </div>
                </div>
                <select v-model="formActivity">
                    <option value="activity">Activity</option>
                    <option value="baseball">Baseball</option>
                    <option value="basketball">Basketball</option>
                    <option value="football">Football</option>
                    <option value="soccer">Soccer</option>
                    <option value="tennis">Tennis</option>
                    <option value="ultimateFrisbee">Ultimate Frisbee</option>
                    <option value="volleyball">Volleyball</option>
                </select>
                <select v-model="formLevel">
                    <option value="level">Level</option>
                    <option value="allLevels">All levels</option>
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                </select>

        </div>
        <div class="form-group" id="timePicker" style="display:none">
            <p>
                <input id="datePicker" type="text" class="date form-control string" autocomplete="off" placeholder="Date" />
                <input id="startTimePicker" type="text" class="time ui-timepicker-input form-control string" autocomplete="off" placeholder="From"
                />
                <input id="endTimePicker" type="text" class="time ui-timepicker-input form-control string" autocomplete="off" placeholder="To"
                />
            </p>
        </div>

        <div v-if="isAddingGame">
            <form action="#" v-on:submit.prevent class="form-horizontal" enctype="multipart/form-data" method="post">
                <div class="form-group">
                    <div>
                        <input class="form-control string" v-model="formLocation" placeholder="Location" />
                    </div>
                </div>
                <div class="form-group">
                    <div>
                        <textarea class="form-control string" v-model="formDescription" placeholder="Description">
                        </textarea>
                    </div>
                </div>
            </form>

        </div>


        <div class="button_bar">
            <button v-if="!isAddingGame && user !== null" class="btn" v-on:click="addGameButton()" :disabled="!loggedIn" v-bind:class="{'disabled': !loggedIn}">
                <i class="fa fa-plus"></i> Add Game
            </button>
            <div v-if="!user" class="login_button">
                <a href="{{=URL('default', 'user')}}" class="btn">Login</a>
            </div>
            <button v-if="isAddingGame" class="btn red" v-on:click="addGame()">
                <i class="fa fa-plus"></i> Add
            </button>
            <button v-if="isAddingGame" class="btn" v-on:click="cancelAddGame()">
                <i class="fa fa-times"></i> Cancel
            </button>
        </div>

        <div v-for="game in games" class="game">
            <div class="game_text">
                <div class="game_title">${game.title}</div>
                <div class="game_content">${game.activity}</div>
                <div class="game_content">${game.gameLevel}</div>
                <div class="game_content">${game.gameDate}</div>
                <div class="game_content">${game.startTime} - ${game.endTime}</div>
                <div class="game_content">${game.gameLocation}</div>
                <div class="game_content">${game.description}</div>
            </div>
            <div class="button_list">
                <div v-if="user != null && game.userEmail == user.email" class="buttons">
                    <a class="btn rounded">
                        <i class="fa fa-edit fa-lg"></i>
                    </a>
                    <a class="btn rounded red" v-on:click="deleteGame(game)">
                        <i class="fa fa-trash fa-lg"></i>
                    </a>
                </div>
                <div v-else class="buttons">
                    <a class="btn rounded" style="background-color: gray">
                        <i class="fa fa-edit fa-lg"></i>
                    </a>
                    <a class="btn rounded" style="background-color: gray">
                        <i class="fa fa-trash fa-lg"></i>
                    </a>
                </div>
            </div>
            <hr>
            <div class="game-join">
                ${game.players.length} ${game.players.length===1 ? "person" : "people"} joined
                <button v-if="user != null && user.email != null && !game.players.includes(user.id)" v-on:click="joinGame(game)">Join Game</button>
                <button v-if="user != null && user.email != null && game.players.includes(user.id)" v-on:click="leaveGame(game)">Leave Game</button>
            </div>
            <hr>
            <div class="comments">
                <div class="comment">

                </div>
            </div>
        </div>

    </div>
</div>

<script src="{{=URL('static', 'js/default_index.js')}}"></script>